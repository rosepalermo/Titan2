% analytical error test

%% calculate strength loss for each
% wave
% load('circle_init.mat')
% load('p_circle_init.mat')
% p.Kwave = 0.001;
% p.Ao = 25*pi;
% p.runname = ('/Users/rosepalermo/Documents/Research/Titan/ModelOutput/paper1/modelmethods/circle_analytical_error/wave_sf1p1');
% p.doWaveErosion = 1;
% lake = ~init;
% p.dt = 1;
% p.So = 1;
% p.dxo = 100;
% p.doStreamPower = 0;
% p.doLandslides = 0;
% p.doUniformErosion = 1;
% p.doWaveErosion = 0;
% p.tf = 10000;
% 
% % grid shoreline and calculate strength loss over 100 years with time steps
% % varying from 5 to 100 years
% % dx = [5 18 45 90];
% tend = 10000;
% 
% [strengthloss,totalSloss_frac,test] = calcstrengthloss(lake,dt(t),tend,p,dx(i),0);
% 
% % solution = Tadpole(init*10,p);

%% uniform
load('circle_init.mat')

load('p_circle_init.mat')
p.con8 = 0; % 1- no corners, 0-corners
p.aerrortest=1;
p.saveint = 100;
p.Kuniform = 0.00001;
p.Kwave = 0.000001;
p.Ao = 25*pi;
lake = ~init;
p.dt = 1;
p.So = 1;
p.dxo = 100;
p.doUniformErosion = 1;
p.doWaveErosion = 0;
p.tf = 1000;
p.strength = p.So*p.dx.^2./p.dxo^2;
p.sensitivity = ;
p.runname = ('/Users/rosepalermo/Documents/Research/Titan/ModelOutput/paper1/modelmethods/circle_analytical_error/uniform_t1000_con8_0_sens_20');
solution = Tadpole(init*10,p);
figure()
imagesc(solution(:,:,end)); title('con8 = 0')

%% analyze output